<?php
namespace Rpt\Manage;
class Manager extends \Rpt\KVObjBase
{
    /**
     * 
     * @param string $managerId
     * @return \Rpt\Manage\Manager
     */
    public static function getByManagerId($managerId) {
        list($u,$cf)= explode('@', $managerId);
        return parent::getCopy(array('cameFrom'=>$cf,'loginName'=>$u));
    }
    /**
     * 
     * @return \Rpt\Manage\Manager
     */
    public static function getByLoginname($camefrom,$loginname) {
        return parent::getCopy(array('cameFrom'=>$camefrom,'loginName'=>$loginname));
    }
    public static function getCopy($pkey) {
        throw new \ErrorException('use getByManagerId or getByLoginname');
    }
    protected function onInit()
    {
        //$this->className = 'UserDsk';
        
        parent::onInit();
        $this->field_locker='rowLock';//  悲观锁用的字段名，默认使用'rowLock'，设置为null表明不需要悲观锁
        $this->_tbName = 'tb_managers_{i}';//表名的默认模板
    }

    public function setField($k, $v)
    {
        if($k == 'passwd')$v = md5($v);
        parent::setField($k, $v); // TODO: Change the autogenerated stub
    }
}
